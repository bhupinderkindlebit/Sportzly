/*
StesCodes Grid Plugin
Copyright (c) 2013  www.stescodes.com
You can use the script on you website for free but this comment part should not be removed. If you modify the library, you should report the modification to 
StesCodes(support@stescodes.com) and the modification should be shared with StesCodes 
version 1.1 (1-JAN-2013)
Authors: StesCodes
*/
var StesCodesGrid=function(){var b={columns:[],rows:[],target:{},height:"100%",columnChooser:!0,columnRearrange:!0,haveExpander:!0,width:"100%",parentContainer:{},paginationBottom:!1,paginationTop:!1,pageSize:5,startIndex:0,currentPageSize:0,rowBdrColor:"#EDEDED",hdrBdrColor:"#fff",hlightClr:"#FFD63A",hdrColor:"#fff",rowColor:"#000",rowBgColor:"white",hdrBgColor:"#799DC4",expander:"",sort:{index:"",dir:"asc"},sortHandler:{}},s=0,t=0,u=function(){b.target.width(0==b.width?b.parentContainer.width()-
100:b.width);for(var a=$(".stesgridholder").find(".stesgridrow").eq(0).find(".stesgridcell"),e=a.length,c=0;c<e;c++){var g=a.eq(c),d=$(".stesgrid").find(".steshdrcell").eq(c);d.width(g.width());d.find(".gridhdrcellholdr").width(g.width())}a=$(".steshdrcell");a.eq(a.length-1).css("border-right","none");$(".stesheader").width($(".stesgrid").width()-17)},v=function(a){if(b){a.columns&&(b.columns=a.columns);a.target&&(b.target=a.target);a.rows&&(b.rows=p(a.rows)?a.rows():a.rows);a.height&&(b.height=a.height);
a.expander?b.haveExpander=a.expander:!1==a.expander&&(b.haveExpander=!1);a.columnChooser?b.columnChooser=a.columnChooser:!1==a.columnChooser&&(b.columnChooser=!1);a.columnRearrange?b.columnRearrange=a.columnRearrange:!1==a.columnRearrange&&(b.columnRearrange=!1);a.parentContainer&&(b.parentContainer=a.parentContainer);a.body.borderColor&&(b.rowBdrColor=a.body.borderColor);a.header.borderColor&&(b.hdrBdrColor=a.header.borderColor);a.header.bgColor&&(b.hdrBgColor=a.header.bgColor);a.header.color&&(b.hdrColor=
a.header.color);a.body.color&&(b.rowColor=a.body.color);a.body.highlightColor&&(b.hlightClr=a.body.highlightColor);a.body.bgColor&&(b.rowBgColor=a.body.bgColor);a.rowClick&&(b.rowClick=a.rowClick);a.callbacks&&(a.callbacks.expander&&(b.expander=a.callbacks.expander),a.callbacks.sort&&(b.sortHandler=a.callbacks.sort));a.pageSize&&(b.pageSize=a.pageSize);if(a.paginationBottom||!1==a.paginationBottom)b.paginationBottom=a.paginationBottom;if(a.paginationTop||!1==a.paginationTop)b.paginationTop=a.paginationTop;
b.width=a.width?a.width:a.parentContainer.width()}},p=function(a){var b={};return a&&"[object Function]"===b.toString.call(a)},q=function(a){if(a)try{return a="<div>"+a+"</div>",$(a).text()||""==$(a).text()?$(a).text():a}catch(b){return a}return""},w=function(a,e,c){"remove"==c?delete b.columns[a].sort:b.columns[a].sort=e},x=function(){n($(".stesgridrow"),["click"]);b.haveExpander?$(".stesgridrow").click(function(){StesCodesGrid.rowClick($(this));StesCodesGrid.buildExpander($(this))}):b.rowClick&&
$(".stesgridrow").click(function(){StesCodesGrid.rowClick($(this))});0==t&&(t=1,$(window).resize(function(){StesCodesGrid.resize()}),$(document).click(function(){$(".colChooser,.chooserList").hide();$(".currfc").removeClass("currfc").hide()}));n($(".gridhdrcellholdr"),["click","mouseover"]);$(".gridhdrcellholdr").click(function(){StesCodesGrid.sort($(this))});$(".gridhdrcellholdr").mouseover(function(){$(".chooserList").hide();$(".currfc").removeClass("currfc").hide()});$(".stesbody").unbind("scroll");
$(".stesbody").scroll(function(){$(".stesheader").scrollLeft($(".stesbody").scrollLeft());$(".chooserList").hide();$(".currfc").removeClass("currfc").hide()});n($(".steshdrcell"),["mouseover","mouseout"]);b.columnChooser&&($(".steshdrcell").mouseover(function(){var a=$(this).find(".colChooser");jQuery.browser.mozilla?a.show().css("left",$(this).closest(".steshdrcell").position().left+$(this).closest(".steshdrcell").width()-7):a.show().css("right",2)}),$(".steshdrcell").mouseout(function(){$(this).find(".colChooser").hide();
$(this).find(".chooserList").hide()}),n($(".colChooser"),["click"]),$(".colChooser").click(function(a){StesCodesGrid.fields($(this).closest(".steshdrcell"));StesCodesGrid.stopProp(a)}));b.columnRearrange?(n($(".steshdrcell"),["draggable"]),n($(".gridhdrcellholdr"),["droppable"]),$(".steshdrcell").draggable({containment:[10,10,$(".stesgrid").width(),$(".steshdrcell").eq(0).height()],start:function(){$(".tdRowCls"+$(this).attr("refindx")).addClass("dragBdr")},drag:function(){$(".tdRowCls"+$(this).attr("refindx")).css({position:"relative",
left:$(this).css("left"),zIndex:99})},stop:function(){$(".tdRowCls"+$(this).attr("refindx")).removeClass("dragBdr");StesCodesGrid.reArrange()}}),$(".gridhdrcellholdr").droppable({over:function(a,b){var c=$(this).closest(".steshdrcell"),g=c.attr("dragIndx"),d=$(".dragBdr").eq(0),h=d.attr("dragIndx");d.attr("dragIndx",g);g=0<b.position.left?-1*b.draggable.width():b.draggable.width();$(".tdRowCls"+c.attr("refindx")).css({position:"relative",left:g,zIndex:99}).attr("dragIndx",h)}})):n($(".steshdrcell"),
["draggable"])},n=function(a,b){for(var c=b.length;c--;)a.unbind(b[c])},A=function(a,b,c){var g=eval("("+JSON.stringify(b)+")");if(0<b.length){var d=b;return b[0][a]?(d.sort(function(c,d){b=g;if("number"==typeof b[0][a])return c[a]-d[a];if("Invalid Date"!=new Date(b[0][a]))return new Date(c[a])-new Date(d[a]);var l=c[a].toLowerCase(),f=d[a].toLowerCase();return l<f?-1:l>f?1:0}),void 0==c||"asc"==c.toLowerCase()?d:d.reverse()):d}return b},y=function(a,b,c){$(".itemFrom").html(b);$(".itemTo").html(c);
$(".itemCount").html(a)},r=function(){var a=".stesheaderbodleft{border-left:1px solid "+b.hdrBdrColor+"}\n",a=a+(".stesheaderbodright{border-right:1px solid "+b.hdrBdrColor+"}\n"),a=a+(".stesgridcell{border:1px solid "+b.rowBdrColor+";border-left:none;border-top:none;padding:5px;padding-top:3px;padding-bottom:3px}\n"),a=a+(".bodleft{border-left:1px solid "+b.rowBdrColor+"}.stesheaderhldr{background-color:"+b.hdrBgColor+";width:100%}.stesgridrow{background-color:"+b.rowBgColor+"}"),e="";"100%"==b.width&&
(e="width:"+(parseInt(b.width.toString().toLowerCase().replace("px",""))-17)+"px;");a+=".expbdr{border-bottom:1px solid "+b.rowBdrColor+";border-top:none}.stesheader{overflow:hidden;border-right:1px solid "+b.hdrBdrColor+";"+e+"position:relative;background-color:"+b.hdrBgColor+"}";a+=".stesbody{height:100px;overflow: auto;overflow-y:scroll;width:"+b.width+"}.stesgrid{overflow: hidden;border:1px solid "+b.rowBdrColor+("100%"==b.height?";border-bottom:none":"")+";border-top:none}";a+=".stesgridrow:hover{background-color:"+
b.hlightClr+";cursor:pointer}.stesrowhover{background-color:"+b.hlightClr+";cursor:pointer}";a+=".steshdrcell{border:none;border-right:1px solid "+b.hdrBdrColor+";color:White;text-align:center;padding:5px;padding-top:3px;padding-bottom:3px;cursor:pointer}";$("<style type='text/css'> "+a+" </style>").appendTo("head");var a=b.columns,e=b.rows,c=b.target,g=b.height,d=b.pageSize,h;h='<div class="stesheaderhldr"><div class="stesheader"><table cellpadding="0" cellspacing="0"><tr class="stesheaderrow">';
for(var k=a.length,l=0,f=0;f<k;f++)if(void 0==a[f].display||!0==a[f].display){var j=p(a[f].text)?a[f].text():a[f].text;h+='<td dragIndx="'+f+'" refIndx="'+f+'" index="'+a[f].ref+'" style="'+(f+1==k?"border-right:1px solid "+b.hdrBdrColor:"")+(a[f].width?"width:"+a[f].width:"")+'" class="posrel steshdrcell tdRowCls'+f+" "+(0==f?"stesheaderbodleft":f+1==k?"stesheaderbodright":"")+'">';0==l&&a[f].sort&&(l=1,b.sort.index=a[f].ref,b.sort.dir=a[f].sort,j=a[f].sort?'<span id="sort" class="'+(a[f].sort&&
"asc"==a[f].sort?"sortASC":"sortDESC")+'">'+j+"</span>":j);h+='<div style="color:'+b.hdrColor+";"+(a[f].width?"width:"+a[f].width:"")+'" class="wbreak gridhdrcellholdr ellipsis" title="'+q(j)+'" >'+j+'</div><div class="colChooser bgnorep"></div></td>'}h=h+"</tr></table></div></div>"+('<div class="stesbody" style="height:'+g+'"><div class="stesbodywrap">');h+='<table class="stesgridholder" cellpadding="0" cellspacing="0"><tbody>';for(var g=0,k=b.startIndex,m=0,f=0;f<d;f++)if(e[f+k]){h+='<tr class="stesgridrow" title="'+
(f+1+k)+" of "+b.rows.length+'" index="'+f+'">';l=a.length;for(j=0;j<l;j++)if(void 0==a[j].display||!0==a[j].display)m=e[f+k],m=a[j].formatter?a[j].formatter(m[a[j].ref],m):m[a[j].ref],h+='<td style="'+(a[j].width?"width:"+a[j].width:"")+'" class="stesgridcell tdRowCls'+j+'">',h+='<div style="color:'+b.rowColor+";"+(a[j].width?"width:"+a[j].width:"")+'" title="'+q(m)+'" class="fl wbreak gridcellholdr '+(a[j].cls?a[j].cls:"")+'">'+m+"</div></td>",m=j;h+="</tr>";g++}b.currentPageSize=k+g;h+="</tbody></table></div></div>";
c.html(h);$(".tdRowCls"+m).css("border-right","none");x();u()},z=function(){var a;a=b.rows.length;var e=b.currentPageSize+b.startIndex,c;c='<div class="break"></div><div class="stesPagination fl"><div class="pgefstDisabled pgefst fl bgnorep hand"></div><div class="pgeprvDisabled pgeprv fl bgnorep hand"></div><div class="pgeSep fl bgnorep"></div>';c+='<div class="pageDisplayText fl"><div class="fl">Item</div>';c+='<div class="fl pl5 itemFrom">1</div><div class="fl pl5">to</div>';c+='<div class="fl pl5 itemTo">'+
e+'</div><div class="fl pl5">of</div>';c+='<div class="fl pl5 itemCount">'+a+"</div>";c+='</div><div class="pgeSep fl bgnorep"></div>';c+='<div class="'+(e<a?"pgenxt":"pgenxtDisabled")+' fl bgnorep hand"></div><div class="'+(e<a?"pgelst":"pgelstDisabled")+' fl bgnorep hand"></div>';a=c+='<div class="break"></div></div><div class="break">';$(".stesPagination").remove();b.paginationBottom&&(!1==b.target.next().next().hasClass("stesPagination")||0==$(".stesgrid").next().next().length)&&b.target.after(a);
b.paginationTop&&(!1==b.target.prev().prev().hasClass("stesPagination")||0==$(".stesgrid").prev().prev().length)&&b.target.before(a);$(".pgefst").unbind("click");$(".pgelst").unbind("click");$(".pgeprv").unbind("click");$(".pgenxt").unbind("click");$(".pgefst").bind("click",function(){$(".pgefst").hasClass("pgefstDisabled")||(StesCodesGrid.processIcons(["pgefst","pgeprv"],["pgenxt","pgelst"]),StesCodesGrid.page("first"))});$(".pgelst").bind("click",function(){$(".pgelst").hasClass("pgelstDisabled")||
(StesCodesGrid.processIcons(["pgenxt","pgelst"],["pgefst","pgeprv"]),StesCodesGrid.page("last"))});$(".pgeprv").bind("click",function(){$(".pgeprv").hasClass("pgeprvDisabled")||(0>StesCodesGrid.getConfig().startIndex-2*StesCodesGrid.getConfig().pageSize?StesCodesGrid.processIcons(["pgefst","pgeprv"],["pgenxt","pgelst"]):StesCodesGrid.processIcons([],["pgenxt","pgelst"]),StesCodesGrid.page("prev"))});$(".pgenxt").bind("click",function(){$(this).hasClass("pgenxtDisabled")||(StesCodesGrid.getConfig().currentPageSize>=
StesCodesGrid.getConfig().rows.length-StesCodesGrid.getConfig().pageSize&&StesCodesGrid.processIcons(["pgenxt","pgelst"],[]),StesCodesGrid.processIcons([],["pgefst","pgeprv"]),StesCodesGrid.page("next"))})};return{resize:u,init:function(a,e){e&&(s=0);0==s&&(b.startIndex=0,b.currentPageSize=0,v(a),z(),window.setTimeout("StesCodesGrid.refresh()",200))},buildExpander:function(a){var e="collapse",c="";a.next().hasClass("stesexpander")?(a.next().remove(),p(b.expander)&&b.expander(a.attr("index"),parseInt(a.attr("index"))-
1,b.rows[a.attr("index")],e,a,c)):(e="expand",c='<tr class="stesexpander '+e+'"><td colspan="'+b.columns.length+'" class="expbdr">',c+='<div class="expContainer"></div></td></tr>',c=a.after(c).next(),c.mouseover(function(){$(this).prev().addClass("stesrowhover")}),c.mouseout(function(){$(this).prev().removeClass("stesrowhover")}),c=c.find(".expContainer"));p(b.expander)&&b.expander(a.attr("index"),b.rows[a.attr("index")],e,a,c);a.find(".stesgridcell").css("border-bottom","expand"==e?"none":"1px solid "+
b.rowBdrColor)},sort:function(a){if(!1!=b.columns[a.closest(".steshdrcell").attr("refindx")].sort){b.startIndex=0;b.currentPageSize=b.pageSize;y(b.rows.length,b.startIndex+1,b.currentPageSize);var e=a.find("#sort"),e=0<e.length?e.hasClass("sortASC")?"desc":"asc":"asc",c=b.columns,g=c.length;refKey=a.closest(".steshdrcell").attr("index");for(var d=0;d<g;d++)c[d].ref==refKey?!1!=c[d].sort&&w(d,e,"add"):!1!=c[d].sort&&w(d,e,"remove");b.rows=A(refKey,b.rows,e);r();p(b.sortHandler)&&b.sortHandler(a,b,
refKey)}else void 0!==b.sortHandler&&b.sortHandler(a,b,a.closest(".steshdrcell").attr("index"))},fields:function(a){$(".chooserList").remove();for(var e=b.columns.length,c='<div class="posabs chooserList" style="border: 1px solid '+b.rowBdrColor+';"><ul class="fl">',g=0;g<e;g++){var d="";if(void 0==b.columns[g].display||!1!=b.columns[g].display)d=' checked="checked" ';c+='<li><input type="checkbox" index="'+g+'" class="chooseChkbox" id="ChooseChk'+g+'" '+d+'/><label for="ChooseChk'+g+'">'+b.columns[g].text+
"</label></li>"}b.target.append(c+"</ul></div>");e=$(".chooserList").find("ul").width()+20;$(".chooserList").width(e);e=a.find(".gridhdrcellholdr");c=a.closest(".stesheaderrow");c.eq(c.length-1).find(".colChooser:visible");jQuery.browser.mozilla?$(".chooserList").css({left:e.closest(".steshdrcell").width()+e.closest(".steshdrcell").position().left-5,top:e.position().top+11}):$(".chooserList").css({left:a.position().left+a.width()-2,top:e.position().top+11});a.find(".colChooser").addClass("currfc");
n($(".chooserList"),["mouseover","mouseout"]);$(".chooserList").mouseover(function(){$(".currfc").show()});$(".chooseChkbox").click(function(a){var b=$(this).attr("index");"checked"==$(this).attr("checked")||!0==$(this).attr("checked")?StesCodesGrid.column(b,"show"):StesCodesGrid.column(b,"hide");$(".chooserList").hide();$(".currfc").removeClass("currfc").hide();StesCodesGrid.resize();StesCodesGrid.stopProp(a)})},getConfig:function(){return b},page:function(a){"first"==a?b.startIndex=0:"last"==a?
(a=b.rows.length-Math.floor(b.rows.length/b.pageSize)*b.pageSize,b.startIndex=0==a?b.rows.length-b.pageSize:b.rows.length-a):"prev"==a?b.startIndex=parseInt(b.startIndex)-parseInt(b.pageSize):"next"==a&&(b.startIndex=parseInt(b.startIndex)+parseInt(b.pageSize));r();y(b.rows.length,b.startIndex+1,b.currentPageSize)},stopProp:function(a){a.stopPropagation?a.stopPropagation():window.event&&(a.cancelBubble=!0)},processIcons:function(a,b){for(var c=a.length,g=0;g<c;g++)$("."+a[g]+"").addClass(a[g]+"Disabled");
c=b.length;for(g=0;g<c;g++)$("."+b[g]+"").removeClass(b[g]+"Disabled")},column:function(a,e){if("hide"==e)b.columns[a].display=!1,$(".tdRowCls"+a).remove();else{b.columns[a].display=!0;var c=p(b.columns[a].text)?b.columns[a].text():b.columns[a].text,g="",d="";a==b.columns.length-1&&(g="border-left:1px solid "+b.rowBdrColor+";border-right:none",d=";border-left:1px solid "+b.hdrBdrColor+";");d='<td dragIndx="'+a+'" refIndx="'+a+'" index="'+b.columns[a].ref+'" style="border-right:1px solid '+b.hdrBdrColor+
d+(b.columns[a].width?";width:"+b.columns[a].width:"")+'" class="steshdrcell stesheaderbodright posrel tdRowCls'+a+'">';d+='<div style="color:'+b.hdrColor+";"+(b.columns[a].width?"width:"+b.columns[a].width:"")+'" class="wbreak gridhdrcellholdr ellipsis" title="'+q(c)+'">'+c+'</div><div class="colChooser bgnorep"></div></td>';c=0;-1<a&&(c=a-1);$(".stesheaderrow").find(".tdRowCls"+c).after(d);for(var h=$(".stesgridrow"),k=h.length,l=0;l<k;l++){var f=b.rows[l],d="";f&&(f=b.columns[a].formatter?b.columns[a].formatter(f[b.columns[a].ref],
f):f[b.columns[a].ref],d+='<td style="'+g+(b.columns[a].width?";width:"+b.columns[a].width:"")+'" class="stesgridcell tdRowCls'+a+'">',d+='<div style="color:'+b.rowColor+(b.columns[a].width?";width:"+b.columns[a].width:"")+'" title="'+q(f)+'" class="fl wbreak gridcellholdr '+(b.columns[a].cls?b.columns[a].cls:"")+'">'+f+'</div><div class="colChooser bgnorep"></div></td>');h.eq(l).find(".tdRowCls"+c).after(d)}x()}$(".stesexpander").each(function(){var a=$(this).prev().find(".stesgridcell");a.css("border-bottom",
"none");a.eq(a.length-1).css("border-right","1px solid "+b.rowBdrColor)})},refresh:function(a){a&&v(a);b.startIndex=0;b.currentPageSize=0;r();z()},reArrange:function(){for(var a=[],e=$(".steshdrcell"),c=0,g=b.columns.length,d=0;d<g;d++){var h=e.eq(d);if(0<h.length){var k=h.attr("refindx"),h=parseInt(h.attr("dragindx"))+c;!1==b.columns[k].display?(a[h]=b.columns[k],c++):a[h]=b.columns[k]}}for(d=0;d<g;d++)void 0==a[d]&&(a[d]=b.columns[d]);b.columns=a;r()},rowClick:function(a){if(b.rowClick){var e=a.closest(".stesgridrow").attr("index");
b.rowClick(e,b.rows[e],"",a)}}}}();